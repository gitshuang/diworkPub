"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.closeGlobalDialog=exports.openGlobalDialog=void 0;var _class,_temp2,_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_modal=require("../bee/modal"),_modal2=_interopRequireDefault(_modal),_utils=require("../utils"),_icon=require("../icon"),_icon2=_interopRequireDefault(_icon),_button2=require("../button");require("./style.css");var _style={btn:"btn__style___20DQM",closeBtn:"closeBtn__style___2Ow_p",pop_type:"pop_type__style___7FzHT",error:"error__style___3lAfZ",warning:"warning__style___rOA-7",danger:"danger__style___2dz2P",success:"success__style___3B6OV"};function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defaults(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var a=n[r],o=Object.getOwnPropertyDescriptor(t,a);o&&o.configurable&&void 0===e[a]&&Object.defineProperty(e,a,o)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):_defaults(e,t))}var PopDialog=(_temp2=_class=function(a){function l(){var e,o;_classCallCheck(this,l);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o=_possibleConstructorReturn(this,a.call.apply(a,[this].concat(n)))).btnClick=function(e,t){var n=e||window.event;window.event?n.cancelBubble=!0:n.stopPropagation();var r=o.props.data?o.props.data:o;if("function"==typeof t.fun)t.fun(r,n);else{var a=o.props.close;"function"==typeof a&&a()}},o.getTypeIcon=function(e){switch(e){case"error":return"error4";case"warning":return"notice";case"danger":return"help-information";case"success":return"succeed"}return""},o.getTypeClass=function(e){switch(e){case"error":return _style.error;case"warning":return _style.warning;case"danger":return _style.danger;case"success":return _style.success}return""},o.getButtonType=function(e,t,n){var r=t.className?t.className:"";switch(e){case"error":return _react2.default.createElement(_button2.ButtonDanger,{key:"danger_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" danger",disabled:!!t.disable},t.label);case"warning":return _react2.default.createElement(_button2.ButtonWarning,{key:"warning_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" warning",disabled:!!t.disable},t.label);case"danger":return _react2.default.createElement(_button2.ButtonBrand,{key:"brand_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" brand",disabled:!!t.disable},t.label);case"defaultAlpha":return _react2.default.createElement(_button2.ButtonDefaultAlpha,{key:"brand_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" defaultalpha",disabled:!!t.disable},t.label);case"u8c":return _react2.default.createElement(_button2.ButtonU8c,{key:"u8c_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" ",disabled:!!t.disable},t.label);case"u8cPrimary":return _react2.default.createElement(_button2.ButtonU8cPrimary,{key:"u8cPrimary_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" ",disabled:!!t.disable},t.label);case"u8cDefault":return _react2.default.createElement(_button2.ButtonU8cDefault,{key:"u8cDefault_pop_btn"+n,onClick:function(e){o.btnClick(e,t)},className:r+" "+_style.btn+" ",disabled:!!t.disable},t.label)}return""},o.getButtonList=function(){var e=o.props,t=e.btns,r=(e.data,[]);return t&&0!=t.length&&t.map(function(e,t){var n=null;n=e.type?o.getButtonType(e.type,e,t):0===t?o.getButtonType("danger",e,t):o.getButtonType("defaultAlpha",e,t),r.push(n)}),r},_possibleConstructorReturn(o,e)}return _inherits(l,a),l.prototype.render=function(){var e=this.props,t=e.type,n=e.backdrop,r=this.getButtonList();return _react2.default.createElement(_modal2.default,{className:(_utils.IS_IE?"ie9_pop":"")+" "+(this.props.className?"pop_dialog "+this.props.className:"pop_dialog")+" "+_style.pop_type+" "+this.getTypeClass(this.props.type),backdrop:n,show:this.props.show,onHide:this.props.close,animation:!1},_react2.default.createElement(_modal2.default.Header,null,_react2.default.createElement(_modal2.default.Title,null,t?_react2.default.createElement(_icon2.default,{type:this.getTypeIcon(t)}):"",this.props.title,_react2.default.createElement("div",{className:_style.closeBtn+" close",onClick:this.props.close},_react2.default.createElement(_icon2.default,{type:"error3"})))),_react2.default.createElement(_modal2.default.Body,null,_react2.default.createElement("div",null,this.props.children?this.props.children:this.props.msg?this.props.msg:"")),_react2.default.createElement(_modal2.default.Footer,null,r))},l}(_react.Component),_class.propTypes={title:_propTypes2.default.string,show:_propTypes2.default.bool,btns:_propTypes2.default.array,close:_propTypes2.default.any,data:_propTypes2.default.any,type:_propTypes2.default.string,backdrop:_propTypes2.default.bool},_class.defaultProps={backdrop:!1},_temp2),Dialog=function e(t){var n=this;_classCallCheck(this,e),this.close=function(){var e=n.props,t=n.props.onClose;"function"==typeof t&&!t()||(e.show=!1,new Promise(function(e){n.render(),setTimeout(function(){e()},1e3)}).then(n.destroy.bind(n)))},this.render=function(){var e=n.props,t=n.div;return _reactDom2.default.render(_react2.default.createElement(PopDialog,_extends({},e,{show:!0}),n.props.content),t),n},this.destroy=function(){var e=n.div;_reactDom2.default.unmountComponentAtNode(e)&&e.parentNode&&e.parentNode.removeChild(e)},this.div=document.createElement("div"),this.props=_extends({},t,{close:t.close?t.close.bind(this):this.close.bind(this)}),document.body.appendChild(this.div),this.render()},globalDialogInstance=void 0,dialogIsOpen=!1;function makeGlobalDialogInstance(e){return globalDialogInstance=new Dialog(e)}function openGlobalDialog(e){var t=makeGlobalDialogInstance.bind(null,e);return globalDialogInstance&&globalDialogInstance.destroy(),t()}function closeGlobalDialog(){globalDialogInstance&&globalDialogInstance.close()}exports.default=PopDialog,exports.openGlobalDialog=openGlobalDialog,exports.closeGlobalDialog=closeGlobalDialog;