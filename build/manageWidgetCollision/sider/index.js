"use strict";var _dec,_class,_class2,_temp,_initialiseProps;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=require("react"),_react2=_interopRequireDefault(_react),_action=require("../core/action"),_action2=_interopRequireDefault(_action);require("./style.css");var _style={add_item:"add_item__style___3ExNW",sider_container:"sider_container__style___6IhSA",toggleBar:"toggleBar__style___1Cm_T",menuListStyle:"menuListStyle__style___2tmSr",card:"card__style___TJQQb",cardLevelFour:"cardLevelFour__style___23gwO",cardLevelThree:"cardLevelThree__style___28iBy",list_item:"list_item__style___3ZqK5",list_item_content:"list_item_content__style___GW5Jo",unSelect:"unSelect__style___2CSzr",isAddColor:"isAddColor__style___3etrI",title_name:"title_name__style___16JSy",iconlocation:"iconlocation__style___3f7Tv",triangle_bottom_right:"triangle_bottom_right__style___361U-",title:"title__style___QeZnm",selectServiceArea:"selectServiceArea__style___1lpsL"},_reactTransitionGroup=require("react-transition-group"),_menuList=require("./menuList"),_menuList2=_interopRequireDefault(_menuList),_card=require("./card"),_card2=_interopRequireDefault(_card),_icon=require("../../icon"),_icon2=_interopRequireDefault(_icon),_cardList=require("./cardList"),_cardList2=_interopRequireDefault(_cardList),_reactRedux=require("react-redux"),_util=require("../core/util");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defaults(e,t){for(var r=Object.getOwnPropertyNames(t),a=0;a<r.length;a++){var n=r[a],i=Object.getOwnPropertyDescriptor(t,n);i&&i.configurable&&void 0===e[n]&&Object.defineProperty(e,n,i)}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):_defaults(e,t))}var changeSiderState=_action2.default.changeSiderState,getAllMenuList=_action2.default.getAllMenuList,updateCheckedCardList=_action2.default.updateCheckedCardList,MySider=(_dec=(0,_reactRedux.connect)((0,_util.mapStateToProps)("isSiderDisplay","manageList","allMenuList","checkedCardList",{namespace:"managewidget"}),{getAllMenuList:getAllMenuList,changeSiderState:changeSiderState,updateCheckedCardList:updateCheckedCardList}))((_temp=_class2=function(r){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,r.call(this,e));return _initialiseProps.call(t),t.state={menuList:[],inputValue:"",isMenuListShow:!1,cardsList:[],keyPath:[],searchValue:""},t}return _inherits(a,r),a.prototype.componentDidMount=function(){var e=this,t=this.props,r=(t.manageList,t.menuList);this.setState({menuList:r},function(){r.length&&e.showServiceAndChangeInput()})},a.prototype.componentWillReceiveProps=function(e){},a.prototype.render=function(){var e,t=this,r=this.state,a=r.inputValue,n=(r.searchValue,r.ifSearchState),i=r.isMenuListShow,c=this.props,s=c.isSiderDisplay,l=c.changeSiderState,o=c.languagesJSON;return _react2.default.createElement(_reactTransitionGroup.TransitionGroup,{component:"div",className:_style.sider_container},_react2.default.createElement(_reactTransitionGroup.CSSTransitionGroup,{transitionName:{enter:"animated",enterActive:"fadeInLeft",leave:"animated",leaveActive:"fadeOutLeft"},transitionEnterTimeout:1300,transitionLeaveTimeout:1300},s?_react2.default.createElement("div",null,_react2.default.createElement("div",{className:"sider-container-fixed"},_react2.default.createElement("div",{style:{position:"absolute",width:320,zIndex:99999,backgroundColor:"#fff"}},_react2.default.createElement("div",{className:_style.add_item},_react2.default.createElement("span",null,_react2.default.createElement(_icon2.default,{type:"notice"}),o.notice)),n?_react2.default.createElement("div",{className:_style.selectServiceArea},_react2.default.createElement(_icon2.default,{type:"search",onClick:this.switchFetchFn,className:"frontSearchIcon"}),_react2.default.createElement("input",_defineProperty({className:_style.selectService,onKeyUp:this.searchService,key:"clickSearch",placeholder:"输入服务名称"},"className","searchInput")),_react2.default.createElement("span",{onClick:this.switchFetchFn,className:"option"},"取消")):_react2.default.createElement("div",{className:_style.selectServiceArea},_react2.default.createElement("input",(_defineProperty(e={className:_style.selectService,value:a,key:"menuSearch"},"className","menuInput"),_defineProperty(e,"disabled","disabled"),e)),_react2.default.createElement("div",{className:"inputMask",onClick:function(){t.setState({isMenuListShow:!i})}}),_react2.default.createElement(_icon2.default,{type:i?"upward":"pull-down",className:"arrow"}),_react2.default.createElement(_icon2.default,{type:"search",onClick:this.switchFetchFn,className:"option"}))),this.renderMenu(),_react2.default.createElement("div",{className:"serviceArea",ref:function(e){return t.serviceArea=e}},this.renderService()))):_react2.default.createElement("div",{style:{width:20}},_react2.default.createElement("i",{className:_style.add_item+" "+_style.toggleBar,style:{position:"fixed"},onClick:l},">"))))},a}(_react.Component),_initialiseProps=function(){var l=this;this.renderMenu=function(){var e=l.state,t=e.menuList,r={isMenuListShow:e.isMenuListShow,menuList:t,showServiceAndChangeInput:l.showServiceAndChangeInput};return _react2.default.createElement(_menuList2.default,r)},this.showServiceAndChangeInput=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:l.state.keyPath,r="",a=[],e=l.state.menuList;e.length&&(t.length&&l.state.menuList.forEach(function(e){e.menuBarCode==t[0]&&(r=e.menuBarName,a=e.menuItems)}),t.length||(a=e[0].menuItems,r=""+e[0].menuBarName),l.setState({cardsList:a,inputValue:r,isMenuListShow:!1,keyPath:t,canShowEmptyDom:!1}))},this.renderService=function(){var a=l.props.checkedCardList,e=l.state,t=e.cardsList,r=e.canShowEmptyDom,n=e.ifSearchState,i="";return!(i=t.map(function(t,e){if(n){var r=a.some(function(e){return e.serviceCode==t.serviceCode});return t.checked=r,_react2.default.createElement("div",{key:t.menuItemId+"-"+e,className:"result_app_list_3"},_react2.default.createElement(_card2.default,{data:JSON.parse(JSON.stringify(t)),key:t.menuItemId+"-"+e,index:e,onChangeChecked:l.onChangeChecked}),_react2.default.createElement("hr",null))}return _react2.default.createElement(_cardList2.default,{key:t.menuItemId,list:t.children,listName:t.menuItemName,checkedCardList:a,onChangeChecked:l.onChangeChecked})})).length&&r&&(i=_react2.default.createElement("div",{className:"emptyDom"},"暂无结果")),i},this.onChangeChecked=function(e,t,r){var a=l.state.cardsList,n=l.props,i=n.checkedCardList,c=n.updateCheckedCardList,s=JSON.parse(JSON.stringify(i));e&&a.forEach(function(e){e.serviceCode!=r||e.children.length||s.push(e),e.children.length&&e.children.forEach(function(e){e.serviceCode==r&&s.push(e)})}),e||a.forEach(function(e){e.serviceCode!=r||e.children.length||(s=s.filter(function(e){return e.serviceCode!==r})),e.children.length&&e.children.forEach(function(e){e.serviceCode==r&&(s=s.filter(function(e){return e.serviceCode!==r}))})}),l.setState({cardsList:a}),c(s)},this.searchService=function(e){if(13==e.keyCode){var r=e.target.value,a=[];l.state.menuList.forEach(function(e,t){e.menuItems.forEach(function(e,t){e.children.forEach(function(e,t){0==e.children.length&&e.service.serviceName&&-1!=e.service.serviceName.indexOf(r)?a.push(e):0!=e.children.length&&e.children.forEach(function(e,t){e.service.serviceName&&-1!=e.service.serviceName.indexOf(r)&&a.push(e)})})})});var n=[];a.forEach(function(t,e){n.some(function(e){return e.serviceCode==t.serviceCode})||n.push(t)}),l.setState({cardsList:n,canShowEmptyDom:!0})}},this.switchFetchFn=function(){l.setState({ifSearchState:!l.state.ifSearchState,cardsList:[]},function(){l.state.ifSearchState||l.showServiceAndChangeInput()})}},_class=_temp))||_class;exports.default=MySider,module.exports=exports.default;