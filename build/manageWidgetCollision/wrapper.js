"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _dec,_class,_class2,_temp,_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_content=require("./content"),_content2=_interopRequireDefault(_content),_footer=require("./footer"),_footer2=_interopRequireDefault(_footer),_popDialogComp=require("./popDialogComp"),_popDialogComp2=_interopRequireDefault(_popDialogComp),_backend=require("./backend"),_backend2=_interopRequireDefault(_backend),_reactDnd=require("react-dnd"),_sider=require("./sider"),_sider2=_interopRequireDefault(_sider),_customDragLayer=require("./dragLayer/customDragLayer.js"),_customDragLayer2=_interopRequireDefault(_customDragLayer),_reactRedux=require("react-redux"),_index=require("./core/index"),_index2=_interopRequireDefault(_index),_action=require("./core/action"),_action2=_interopRequireDefault(_action),_util=require("./core/util");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defaults(e,t){for(var o=Object.getOwnPropertyNames(t),a=0;a<o.length;a++){var r=o[a],n=Object.getOwnPropertyDescriptor(t,r);n&&n.configurable&&void 0===e[r]&&Object.defineProperty(e,r,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):_defaults(e,t))}var returnDefaultState=_action2.default.returnDefaultState,updateGroupList=_action2.default.updateGroupList,emptySelectGroup=_action2.default.emptySelectGroup,setEditState=_action2.default.setEditState,moveGroup=_action2.default.moveGroup,Wrapper=(_dec=(0,_reactRedux.connect)((0,_util.mapStateToProps)("manageList","isEdit",{namespace:"managewidget"}),{returnDefaultState:returnDefaultState,updateGroupList:updateGroupList,emptySelectGroup:emptySelectGroup,setEditState:setEditState,moveGroup:moveGroup}))((_temp=_class2=function(t){function o(e){_classCallCheck(this,o);var a=_possibleConstructorReturn(this,t.call(this,e));return a.moveGroupDrag=function(e,t){(0,a.props.moveGroup)({id:e,afterId:t})},a.batchDelectFn=function(){(0,a.props.batchDelect)(),a.popClose()},a.openGroupTo=function(){(0,a.props.openBatchMove)()},a.popOpen=function(){a.setState({showModal:!0})},a.popClose=function(){a.setState({showModal:!1})},a.save=function(){var e=a.props,t=e.manageList,o=e.save;a.checkBtn&&a.checkBtn.click(),o(t).then(function(e){var t=e.error;e.payload;t||a.goBack(),a.popCloseCancel()})},a.cancel=function(){(0,a.props.setEditState)(!1),a.popCloseCancel(),a.goBack()},a.goBack=function(){a.configBack=!0;var e=a.props,t=e.emptySelectGroup,o=e.goBack;t(),o?o():a.props.history.go(-1)},a.popOpenCancel=function(){_index2.default.getState().isEdit?a.setState({showCancelModal:!0}):a.goBack()},a.popCloseCancel=function(){a.setState({showCancelModal:!1})},a.state={showModal:!1,showCancelModal:!1},a.goToLocation="",a.configBack=!1,a}return _inherits(o,t),o.prototype.componentWillUnmount=function(){(0,this.props.returnDefaultState)()},o.prototype.componentWillMount=function(){var e=this.props.getRef;e&&e(this)},o.prototype.componentDidMount=function(){var o=this,e=this.props.history;null!=e&&e.block(function(e){var t=_index2.default.getState().isEdit;o.goToLocation=e.pathname,e.pathname!==o.props.match.path&&t&&!o.configBack&&o.setState({showCancelModal:!0})})},o.prototype.render=function(){var e=this.props,t=e.languagesJSON,o=e.isEdit,a=e.isFooterDisplay,r=e.roleEdit,n=this.state,i=n.showModal,c=n.showCancelModal,p={save:this.save,showModal:i,showCancelModal:c,popClose:this.popClose,batchDelectFn:this.batchDelectFn,cancel:this.cancel,popCloseCancel:this.popCloseCancel},u={batchDelectFn:this.batchDelectFn,openGroupTo:this.openGroupTo,isEdit:o,save:this.save,popOpenCancel:this.popOpenCancel};return _react2.default.createElement("div",null,_react2.default.createElement("div",{style:{display:"flex",position:"absolute",top:0,right:0,left:0,bottom:0}},_react2.default.createElement(_sider2.default,{languagesJSON:t,menuList:this.props.menuList}),_react2.default.createElement(_content2.default,{languagesJSON:t,groupList:this.props.groupList,moveGroupDrag:this.moveGroupDrag,roleEdit:r}),_react2.default.createElement(_popDialogComp2.default,_extends({},p,{languagesJSON:t})),_react2.default.createElement(_customDragLayer2.default,null)),a?_react2.default.createElement(_footer2.default,_extends({languagesJSON:t},u)):null)},o}(_react.Component),_class2.defaultProps={isFooterDisplay:!0},_class=_temp))||_class;exports.default=(0,_reactDnd.DragDropContext)(_backend2.default)(Wrapper),module.exports=exports.default;