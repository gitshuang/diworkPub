"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _dec,_dec2,_dec3,_class,_class2,_temp,_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_react=require("react"),_react2=_interopRequireDefault(_react),_widgetItemFather=require("./widgetItemFather"),_widgetItemFather2=_interopRequireDefault(_widgetItemFather),_reactDnd=require("react-dnd"),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_icon=require("pub-comp/icon"),_icon2=_interopRequireDefault(_icon),_checkbox=require("../../bee/checkbox"),_checkbox2=_interopRequireDefault(_checkbox),_widgetStyle=require("./widgetStyle"),_reactRedux=require("react-redux"),_u=require("@u"),_actions=require("store/root/manage/actions"),_actions2=_interopRequireDefault(_actions),_reactDom=require("react-dom");require("./style.css");var _style={widgetItem:"widgetItem__style___1TZRU",widgetFileItem:"widgetFileItem__style___3aYXU",title:"title__style___3mTID",title_right:"title_right__style___2_nSB",file_title_right:"file_title_right__style___d4ef_",widget_node:"widget_node__style___3KtrV",content:"content__style___2IGI-",context:"context__style___mKQQ2",bottom:"bottom__style___qEihN",file_context:"file_context__style___3qf7s",footer:"footer__style___IlBvD",editDele:"editDele__style___2b3y7",title_cont:"title_cont__style___3oqUh",edit_cont:"edit_cont__style___3vuV1",edit_btn:"edit_btn__style___HLMAv",title_edit:"title_edit__style___1fShV",clearfix:"clearfix__style___2UztU",addModule:"addModule__style___241SG",widgetList:"widgetList__style___1m_e4",pop_dialog_widge_list:"pop_dialog_widge_list__style___bJ5Eb",btn:"btn__style___3vqT7"};function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defaults(e,t){for(var r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++){var a=r[i],_=Object.getOwnPropertyDescriptor(t,a);_&&_.configurable&&void 0===e[a]&&Object.defineProperty(e,a,_)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):_defaults(e,t))}var moveSideCards=_actions2.default.moveSideCards,dropSideCards=_actions2.default.dropSideCards,itemSource={beginDrag:function(e,t,r){return e.manageList.forEach(function(e){e.children.forEach(function(e,t){})}),{id:e.id,parentId:e.parentId,type:e.type,props:e,index:e.index}},isDragging:function(e,t){return t.getItem().id===e.id}},itemTarget={hover:function(e,t,r){var i=t.getItem().id,a=t.getItem().type;if(i!==e.id&&1!==a){var _=t.getItem().parentId,o="cardlist"==a?1:t.getItem().props.data.size,n=e.data.size,s=e.index,d="cardlist"==a?0:t.getItem().props.index,c=(0,_reactDom.findDOMNode)(r).getBoundingClientRect(),l=(c.bottom,c.top,(c.right-c.left)/2),u=t.getClientOffset(),p=(u.y,c.top,u.x-c.left);if(o<n){if(d<s&&p<l)return;if(s<d&&l<p)return}if("cardlist"==a){var f=t.getItem().cardList,g={id:i,preParentId:_,afterId:e.id,parentId:e.data.parentId,afterType:e.data.type,monitor:t,cardList:f};e.moveSideCards(g)}else e.moveItemDrag(i,_,a,e.id,e.data.parentId,e.data.type,t),t.getItem().index=e.index}},drop:function(e,t){if("cardlist"==t.getItem().type){var r=t.getItem().id,i=t.getItem().parentId,a=(t.getItem().type,t.getItem().cardList),_={id:r,preParentId:i,afterId:e.id,parentId:e.data.parentId,afterType:e.data.type,monitor:t,cardList:a};e.dropSideCards(_)}}},WidgetItem=(_dec=(0,_reactRedux.connect)((0,_u.mapStateToProps)("manageList","shadowCard",{namespace:"manage"}),{moveSideCards:moveSideCards,dropSideCards:dropSideCards}))(_class=(_dec2=(0,_reactDnd.DropTarget)("item",itemTarget,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(_class=(_dec3=(0,_reactDnd.DragSource)("item",itemSource,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((_temp=_class2=function(r){function i(e){_classCallCheck(this,i);var t=_possibleConstructorReturn(this,r.call(this,e));return t.state={title:""},t}return _inherits(i,r),i.prototype.render=function(){var e=this,t=this.props.languagesJSON,r=this.props.data,i=r.widgetId,a=r.size,_=r.widgetName,o=this.props,n=o.connectDragSource,s=o.connectDropTarget,d=o.isDragging,c=o.selectList,l=(o.index,o.isOver,c.indexOf(i),d?{opacity:.5,backgroundColor:"rgba(255,255,255,1)",color:"blue"}:{}),u=this.state.title;return n(s(_react2.default.createElement("li",{title:u,className:_style.widgetItem+" "+_style.widget_node+"  ",style:_extends({},_widgetStyle.widgetStyle[a-1],l)},_react2.default.createElement("div",{className:u},d?null:_react2.default.createElement("div",{className:_style.title_right},_+" ")),_react2.default.createElement("div",{className:_style.widgetItemCont}),d?null:_react2.default.createElement("div",{className:_style.clearfix+" "+_style.footer},_react2.default.createElement("div",{className:_style.editDele+" "+_style.clearfix},_react2.default.createElement("div",{onClick:function(){e.popSave(e.props.data)}},_react2.default.createElement(_icon2.default,{title:t.deleteService,type:"dustbin"})))))))},i}(_widgetItemFather2.default),_class2.propTypes={connectDragSource:_propTypes2.default.func.isRequired,connectDropTarget:_propTypes2.default.func.isRequired,isDragging:_propTypes2.default.bool.isRequired},_class2.defaultProps={isDragging:!1},_class=_temp))||_class)||_class)||_class;exports.default=WidgetItem,module.exports=exports.default;