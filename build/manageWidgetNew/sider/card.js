"use strict";var _dec,_dec2,_class;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=require("react"),_react2=_interopRequireDefault(_react),_reactDnd=require("react-dnd"),_reactDndHtml5Backend=require("react-dnd-html5-backend"),_reactRedux=require("react-redux"),_utils=require("../utils"),_u=require("@u");require("./style.css");var _style={add_item:"add_item__style___33Wyp",sider_container:"sider_container__style___1L4Ic",toggleBar:"toggleBar__style___2EItX",menuListStyle:"menuListStyle__style___13ktw",card:"card__style___3NQiR",cardLevelFour:"cardLevelFour__style___XWUVD",cardLevelThree:"cardLevelThree__style___2vCJy",list_item:"list_item__style___15jnV",list_item_content:"list_item_content__style___3oXP9",unSelect:"unSelect__style___1lSvW",isAddColor:"isAddColor__style___xOtdw",title_name:"title_name__style___yIeE9",iconlocation:"iconlocation__style___28d9d",triangle_bottom_right:"triangle_bottom_right__style___2l_cC",title:"title__style___2S1uq",selectServiceArea:"selectServiceArea__style___3REIN"},_actions=require("store/root/manage/actions"),_actions2=_interopRequireDefault(_actions);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defaults(e,t){for(var r=Object.getOwnPropertyNames(t),a=0;a<r.length;a++){var c=r[a],i=Object.getOwnPropertyDescriptor(t,c);i&&i.configurable&&void 0===e[c]&&Object.defineProperty(e,c,i)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):_defaults(e,t))}var updateManageList=_actions2.default.updateManageList,noteSource={beginDrag:function(e,t,r){e.checkedCardList.forEach(function(e){e.size=1,e.type=3,e.widgetId=e.service.serviceId,e.widgetName=e.service.serviceName,e.serviceCode=e.service.serviceCode,e.icon=e.service.serviceIcon,e.size=e.widgetTemplate.size,e.serviceType=e.widgetTemplate.serviceType});var a=e.data;return a.size=1,a.type=3,a.widgetId=a.service.serviceId,a.widgetName=a.service.serviceName,a.serviceCode=a.service.serviceCode,a.icon=a.service.serviceIcon,a.size=a.widgetTemplate.size,a.serviceType=a.widgetTemplate.serviceType,a.checked||e.checkedCardList.push(a),{id:"shadowCardId",type:"cardlist",parentId:2,cardList:e.checkedCardList}},endDrag:function(e,t,r){var a=t.getItem(),c=e.manageList,i=e.updateManageList;t.didDrop()?console.log("正常拖拽"):(c.forEach(function(r){r.children.forEach(function(e,t){e.widgetId==a.id&&r.children.splice(t,1)})}),i(c))},canDrag:function(e,t){var r=e.manageList,a=e.data;return!e.hasBeenDragged&&!(0,_utils.hasCardContainInGroups)(r,a.service.serviceId)}},Card=(_dec=(0,_reactRedux.connect)((0,_u.mapStateToProps)("manageList","checkedCardList",{namespace:"manage"}),{updateManageList:updateManageList}))(_class=(_dec2=(0,_reactDnd.DragSource)("item",noteSource,function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}}))(_class=function(t){function r(e){_classCallCheck(this,r);var c=_possibleConstructorReturn(this,t.call(this,e));return c.clickSiderCard=function(){var e=c.props.data,t=e.menuItemId,r=e.parentId,a=e.checked;c.props.onChangeChecked(!a,r,t)},c}return _inherits(r,t),r.prototype.componentDidMount=function(){this.props.connectDragPreview((0,_reactDndHtml5Backend.getEmptyImage)(),{captureDraggingState:!0})},r.prototype.render=function(){var e=this.props,t=e.connectDragSource,r=e.manageList,a=this.props.data,c=a.serviceId,i=a.service.serviceName,n=a.checked,s=(0,_utils.hasCardContainInGroups)(r,c);return t(_react2.default.createElement("div",null,s?_react2.default.createElement("div",{className:"app_col"},_react2.default.createElement("div",{className:_style.list_item_content+" "+_style.title+" "+_style.isAddColor},_react2.default.createElement("span",{className:_style.title_name},i))):_react2.default.createElement("div",{className:"app_col",onClick:this.clickSiderCard},_react2.default.createElement("div",{className:_style.list_item_content+" "+_style.title+" "+(n?"item-checked":null)},_react2.default.createElement("span",{className:_style.title_name,title:i},i),n?_react2.default.createElement("i",{className:"selected",style:{color:"rgb(0, 122, 206)"}}):null))))},r}(_react.Component))||_class)||_class;exports.default=Card,module.exports=exports.default;