"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IS_IE=exports.getHost=exports.logout=exports.createActions=exports.createTypes=exports.mergeReducers=exports.noop=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};exports.post=post,exports.deleteRequest=deleteRequest,exports.postFileCros=postFileCros,exports.get=get,exports.mapStateToProps=mapStateToProps,exports.guid=guid,exports.findPath=findPath,exports.avoidSameName=avoidSameName,exports.getContext=getContext,exports.getStrLenSubstr=getStrLenSubstr,exports.browserRedirect=browserRedirect,exports.postMessageToWin=postMessageToWin,exports.GetQueryString=GetQueryString,exports.getNewEvent=getNewEvent,exports.equals=equals;var _reduxActions=require("redux-actions");function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function _toArray(e){return Array.isArray(e)?e:Array.from(e)}var noop=exports.noop=function(){},getLocaleIndex=function(){var e=["en_US","zh_TW","fr_FR","de_DE","ja_JP"];if(window.diworkContext&&"function"==typeof window.diworkContext){var t=getContext().locale;return e.findIndex(function(e){return e===t})}if(window.managerContext){var o=window.managerContext.locale;return e.findIndex(function(e){return e===o})}return-1},mergeReducers=exports.mergeReducers=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return function(o,r){return t.reduce(function(e,t){return _extends(e,t(o,r))},{})}},createTypes=exports.createTypes=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return t.reduce(function(e,t){return e[t]=t,e},{})},createActions=exports.createActions=function(e){for(var t=arguments.length,o=Array(1<t?t-1:0),r=1;r<t;r++)o[r-1]=arguments[r];var n=[];if("object"===(void 0===e?"undefined":_typeof(e))&&e.namespace){var i=_toArray(o),c=i[0],a=i.slice(1),s={},p=(n=e.namespace.split(".")).reduce(function(e,t){return e[t=t.toUpperCase()]={},e[t]},s);"object"===(void 0===c?"undefined":_typeof(c))?_extends(p,c):a=[c].concat(a),a.reduce(function(e,t){return e[t]=void 0,e},p);var u=(0,_reduxActions.createActions)(s);return n.reduce(function(e,t){return e[t]?e[t]:e},u)}return o=[e].concat(o),_reduxActions.createActions.apply(void 0,_toConsumableArray(o))},logout=exports.logout=function(){window.sessionStorage.getItem("TABS_DATA")&&window.sessionStorage.removeItem("TABS_DATA");var e=getContext(),t=e.defaultDesktop,o=e.productLine;if("portal"===t&&"diwork"===o){deleteRequest(getHost("u8cportal")+"/user/logOut?v=1.0").then(function(e){window.location.href=e.url},function(e){console.log(e)})}else{var r=window.location.origin;window.location.href="/logout?service="+encodeURIComponent((r||"")+"/")}},getHost=exports.getHost=function(e){var t=0<arguments.length&&void 0!==e?e:"api";return{api:{production:process.env.HOST||"",development:process.env.HOST||"",daily:process.env.HOST||"",integrate:process.env.HOST||"",combine:process.env.HOST||"",pre:process.env.HOST||""},workbench:{production:"https://www.diwork.com",development:"http://workbench.yyuap.com",daily:"https://workbench-daily.yyuap.com",integrate:"https://y3me-daily.yyuap.com",combine:"https://u8c-daily.yyuap.com",pre:"https://yonsuite-pre.diwork.com"},portal:{production:"https://ec.diwork.com",development:"http://web.yyuap.com:91",daily:"https://ec-daily.yyuap.com",integrate:"https://ec-daily.yyuap.com",combine:"https://ec-u8c-daily.yyuap.com",pre:"https://ec-yonsuite-pre.diwork.com"},yzone:{production:"https://ec.diwork.com/portal/home/index",development:"http://web.yyuap.com:91/portal/home/index",daily:"https://ec-daily.yyuap.com/portal/home/index",integrate:"https://ec-yonsuite-pre.yyuap.com/",combine:"https://u8c-daily.yyuap.com/portal_index",pre:"https://yonsuite-pre.diwork.com/portal_index"},u8cportal:{production:"https://dwweb-api.diwork.com",development:"http://dwweb.api.yyuap.com:6062",daily:"https://dwweb-api.yyuap.com",integrate:"https://dwweb-api.yyuap.com",combine:"https://dwweb-api-u8c-daily.yyuap.com",pre:"https://y3me-pre.diwork.com/portal_index"},login:{production:"https://euc.diwork.com",development:"https://idtest.yyuap.com",daily:"https://sso-daily.yyuap.com",integrate:"https://sso-daily.yyuap.com",combine:"https://u8c-sso-daily.yyuap.com",pre:"https://sso-y3me-pre.diwork.com"},euc:{production:"https://euc.diwork.com",development:"https://idtest.yyuap.com",daily:"https://user-daily.yyuap.com",integrate:"https://user-daily.yyuap.com",combine:"https://u8c-user-daily.yyuap.com",pre:"https://user-y3me-pre.diwork.com"},user:{production:"https://hr.diwork.com",development:"http://hrcloud.yyuap.com",daily:"https://hr-daily.yyuap.com",integrate:"https://hr-daily.yyuap.com",combine:"https://hr-u8c-daily.yyuap.com",pre:""},market:{production:"https://market.yonyoucloud.com",development:"https://uastest.yyuap.com",daily:"https://market-daily.yyuap.com",integrate:"https://market-daily.yyuap.com",combine:"https://u8cmaket-daily.yyuap.com",pre:"https://market-pre.diwork.com"},honor:{production:"//wsbs.diwork.com",development:"//wsbs.app.yyuap.com",daily:"//wsbs-daily.yyuap.com",integrate:"//wsbs-daily.yyuap.com",combine:"//wsbs-daily.yyuap.com",pre:""},ticket:{production:"https://wo.diwork.com",development:"http://ticket-v2.dev.app.yyuap.com",daily:"http://ticket.app.yyuap.com",integrate:"http://ticket.app.yyuap.com",combine:"http://ticket.app.yyuap.com",pre:""},ref:{production:"https://ms.diwork.com",development:"http://workbench.yyuap.com",daily:"https://ms-daily.yyuap.com",integrate:"https://ms-y3me-daily.yyuap.com",combine:"https://u8cms-daily.yyuap.com",pre:"https://ms-y3me-pre.diwork.com"},org:{production:"https://cdn.yonyoucloud.com/pro/diwork",development:"http://workbenchdev.yyuap.com/fe",daily:"https://cdn.yonyoucloud.com/pro/diwork",integrate:"https://cdn.yonyoucloud.com/pro/diwork",combine:"https://cdn.yonyoucloud.com/pro/diwork",pre:"https://cdn.yonyoucloud.com/pro/diwork"}}[t][process.env.NODE_ENV]},IS_IE=exports.IS_IE=!!window.ActiveXObject||"ActiveXObject"in window,fetchTools={params:function(o){try{return Object.keys(o).map(function(e){var t=o[e];switch(void 0===t?"undefined":_typeof(t)){case"object":t=escape(JSON.stringify(t));break;case"undefined":t=""}return e+"="+t}).join("&")}catch(e){return console.log("error in urlParams"),""}},fetch:function(r){function e(e,t,o){return r.apply(this,arguments)}return e.toString=function(){return r.toString()},e}(function(u,e,d){return fetch(u,e).then(function(e){return e.ok?e.text().then(function(e){if(e){var t={status:0,msg:"接口请求失败"};try{t=JSON.parse(e)}catch(e){return Promise.reject(new Error("接口返回数据无法解析"))}var o=t,r=o.status,n=o.data,i=o.msg,c=o.errorCode,a=o.needrelogin,s={};if(-1<u.indexOf("/ref/diwork/iref_ctr/refInfo"))return Promise.resolve(t);if(r&&"0"!==r||d&&0===t.code){var p=getLocaleIndex();return s=-1<p&&"object"===(void 0===n?"undefined":_typeof(n))?_diff(p+2,n,"set"):n,Promise.resolve(s)}if(a)return Promise.resolve(t);if(c)switch(c){case"000001":logout()}return Promise.reject(i)}return Promise.reject(new Error("接口未返回数据"))}):Promise.reject(new Error("请求失败"))})}),options:function(e,t,o){var r=0<arguments.length&&void 0!==e?e:"get",n=1<arguments.length&&void 0!==t?t:{},i=o,c=i?{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",isAjax:1};return"portal"!==getContext().defaultDesktop||i||(c.isPortal=!0),_extends({method:r.toUpperCase(),credentials:"include",cache:"no-cache",headers:c},n)},url:function(e){if(!e)throw new Error("has no url!");return 0!==e.indexOf("http")&&(e="portal"===getContext().defaultDesktop&&"3000"!==window.location.port?""+getHost("workbench")+e:""+getHost()+e),e}};function post(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2],r=fetchTools.fetch,n=fetchTools.options,i=fetchTools.url,c={},a=getLocaleIndex();c=-1<a?_diff(a+2,t,"get"):t;var s=n("post",{},o);o||(s.headers["Content-Type"]="application/json;charset=UTF-8");try{if(o){var p="";for(var u in c)p+=encodeURIComponent(u)+"="+encodeURIComponent(c[u])+"&";s.body=p}else s.body=JSON.stringify(c)}catch(e){return Promise.reject(e)}return r(i(e),s,o)}function deleteRequest(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=fetchTools.fetch,r=fetchTools.options,n=fetchTools.url,i=r("delete",{},!0);try{var c="";for(var a in t)c+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";i.body=c}catch(e){return Promise.reject(e)}return o(n(e),i,!0)}function postFileCros(e,t){fetchTools.params;var o=fetchTools.fetch,r=fetchTools.options,n=fetchTools.url,i=r("post",{mode:"cors"});delete i.headers;try{i.body=t}catch(e){return Promise.reject(e)}return console.log(i),o(n(e),i)}function get(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2],r=fetchTools.params,n=fetchTools.fetch,i=fetchTools.options,c=fetchTools.url,a=r(t),s=c(e);if("/ref/diwork/iref_ctr/refInfo"===e||-1<e.indexOf("/ref/diwork/iref_ctr/refInfo")){s=e;for(var p=a.split("&"),u={},d=0;d<p.length;++d){var y=p[d].split("=");u[y[0]]=y[1]}return jsonp({url:s,data:u})}a&&(s=s+"?"+a);var l=-1==s.indexOf("?")?"?":"&";return n(s+=l+"tm="+(new Date).getTime(),i("get",{},o),o)}function jsonp(u){return new Promise(function(t,o){var r="jsonp_"+Date.now(),n=document.getElementsByTagName("head")[0],e=document.createElement("script"),i=u.data||{},c=u.url,a=[];for(var s in i.callback=r,i)a.push(s+"="+i[s]);function p(){window[r]=void 0;var e=document.getElementById(r);n.removeChild(e)}c+=/\?/.test(c)?"&":"?",c+=a.join("&"),e.id=r,e.src=c,e.onerror=function(){o(),p()},window[r]=function(e){t(e),p()},e.type="text/javascript";try{n.appendChild(e)}catch(e){o(e)}})}function mapStateToProps(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return t.length?function(o,r){var n=o,e=t.slice(-1)[0].namespace;return e&&(e=e.split("."),o=e.reduce(function(e,t){var o=e[t];return o=o||e},o)),t.reduce(function(e,t){return"string"==typeof t?e[t]=o[t]:"object"===(void 0===t?"undefined":_typeof(t))&&"string"==typeof t.key&&"function"==typeof t.value&&(e[t.key]=t.value(o,r,n)),e},{})}:function(){return{}}}function guid(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"LS-"+(e()+e())+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function findPath(e,a,s,p){var u=[];return function e(t){for(var o=0,r=t.length;o<r;o++){var n=!1,i=t[o];u.push(i),i[a]&&(n=e(i[a]));var c=void 0;try{c=s.split(".").reduce(function(e,t){return e[t]},i)}catch(e){console.log(e)}if(c===p&&(n=!0),n)return n;u.pop()}return!1}(e),u}function avoidSameName(e,t){var o=new RegExp("^"+t+"(\\((\\d+)\\)){0,1}$"),r=0;return e.forEach(function(e){if(o.test(e)){var t=e.match(o)[2];t?(t=parseInt(t,10)+1,r<t&&(r=t)):r=r||1}}),r?t+"("+r+")":t}function getContext(){if(window.diworkContext&&"function"==typeof window.diworkContext){var e=window.diworkContext();return-1<e.productLine.indexOf("u8c")&&(e.productLine="u8c"),e}return{}}function getStrLenSubstr(e,t,o,r){if(!e)return"";return new RegExp("[\\u4E00-\\u9FFF]+","g").test(e)?e.length==t?e:e.length>t?e.substring(0,t)+(r?"":"..."):e:e.length==o?e:e.length>o?e.substring(0,o)+(r?"":"..."):e}function browserRedirect(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),o="iphone os"==e.match(/iphone os/i),r="midp"==e.match(/midp/i),n="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),i="ucweb"==e.match(/ucweb/i),c="android"==e.match(/android/i),a="windows ce"==e.match(/windows ce/i),s="windows mobile"==e.match(/windows mobile/i);return t||o||r||n||i||c||a||s?0!=t.length?"ipad":0!=o.length?"iphone os":0!=r.length?"midp":0!=n.length?"rv:1.2.3.4":0!=i.length?"ucweb":0!=c.length?"android":0!=a.length?"windows ce":0!=s.length?"windows mobile":void 0:"pc"}function postMessageToWin(e,t){e&&t&&e.postMessage(JSON.stringify(t),"*")}function GetQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return null!=o?unescape(o[2]):null}function getNewEvent(e){if(IS_IE){var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!0,!0,void 0),t}return new Event(e,{bubbles:!0})}function equals(e,t){var o=e instanceof Object,r=t instanceof Object;if(!o||!r)return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;var n=Object.keys(e);for(var i in n){var c=e[i=n[i]]instanceof Object,a=t[i]instanceof Object;if(c&&a){var s=equals(e[i],t[i]);if(!s)return s}else if(e[i]!=t[i])return!1}return!0}var _diff=function(u,e,d){return function a(s){if("object"===(void 0===s?"undefined":_typeof(s))&&Array.isArray(s)&&s.length)s.forEach(function(e){"object"!==(void 0===e?"undefined":_typeof(e))||0===e.length&&!Object.keys(e).length||a(e)});else if("object"===(void 0===s?"undefined":_typeof(s))&&Object.keys(s).length){var p=Object.keys(s);p.forEach(function(e,t){var o=e+"Ext"+u,r=e+u;if(p.includes(o)){var n=s[o];if(!n)return;"set"==d?(s.TEMPORARY=s[e],s[e]=n):(s[o]=s[e],s[e]=s.TEMPORARY,delete s.TEMPORARY)}else if(p.includes(r)){var i=s[r];if(!i)return;"set"==d?(s.TEMPORARY=s[e],s[e]=i):(s[r]=s[e],s[e]=s.TEMPORARY,delete s.TEMPORARY)}var c=s[e];c&&("object"!==(void 0===c?"undefined":_typeof(c))||0===c.length&&!Object.keys(c).length||a(c))})}return s}(JSON.parse(JSON.stringify(e)))};